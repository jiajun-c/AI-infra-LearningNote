# 系统整体访存流程

整体访存的流程可以分为

程序(堆/栈空间) -> cache -> TLB -> MMU -> 实际地址

## 1. 程序空间

程序所使用的空间并不直接操作到实际的物理空间，而是直接作用于一个虚拟的地址空间

### 1.1 程序空间的分配

程序所使用的空间主要在堆栈上，栈上的空间在编译时确定大小，存储函数参数等，运行时自动分配，堆上的空间在运行时进行动态的分配，用于malloc,new等库函数

### 1.2 程序空间的管理

栈的空间在函数结束后会自动释放，堆空间需要手动释放，使用free,delete等函数进行释放


## 2. cache


## 3. TLB

TLB也可以被称为是快表，其作用是把虚拟地址转换为物理地址， TLB中存放的基本单位是页表条目项，对应着RAM中存放的页表条目。

## 4. MMU

MMU也被称为是慢表，将CPU送来的虚拟地址分为三段，VA中前两段作为两次查表的索引，第三段作为物理地址的偏移，查表的步骤如下所示：

- 从TTB中取出保存在其中的第一级页表的基地址，这个基地址指的是PA
- 以TTB中的内容为基地址，以VA中的第一步部分在第一级页表中查出第二级页表的基地址
- 基于上面的基地址结合VA中的第二段信息得到对于的物理基础地址
- 将物理基地址加上VA中的第三段信息得到最终的物理地址

